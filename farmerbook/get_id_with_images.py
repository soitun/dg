import glob, os
from boto.s3.connection import S3Connection
from boto.s3.key import Key
from django.core.management import setup_environ
import settings
setup_environ(settings)
from dashboard.models import *

def get_farmer_list():
    person = Person.objects.filter(image_exists = True).values_list('id', flat = True)
    return person

def get_csp_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("csp/")
#    csp_list = []
#    for key in rs:
#        try:
#            csp_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        csp_list.append(csp_id)
    csp_list = [10000000000346L, 10000000000348L, 10000000000350L, 10000000000381L, 10000000000402L, 10000000000403L, 10000000000406L, 10000000000450L, 10000000019320L, 10000000019321L, 10000000019348L, 10000000019419L, 10000000019420L, 10000000019422L, 10000000019426L, 10000000019428L, 10000000019430L, 10000000019431L, 10000000019435L, 10000000019453L, 10000000019495L, 10000000019502L, 10000000019505L, 10000000019506L, 10000000019507L, 10000000019508L, 10000000019515L, 10000000019541L, 10000000019554L, 10000000019696L, 10000000019793L, 10000000019808L, 10000000019823L, 10000000019826L, 10000000019831L, 10000000019844L, 10000000019895L, 10000000019979L, 10000000020020L]
    return csp_list

def get_group_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("group/")
#    group_list = []
#    for key in rs:
#        try:
#            group_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        group_list.append(group_id)
    group_list = [10000000000105L, 10000000000106L, 10000000000107L, 10000000000119L, 10000000000120L, 10000000000121L, 10000000000122L, 10000000000159L, 10000000000306L, 10000000000307L, 10000000000308L, 10000000000309L, 10000000000310L, 10000000000328L, 10000000000329L, 10000000000399L, 10000000000400L, 10000000000402L, 10000000000403L, 10000000000445L, 10000000000446L, 10000000000451L, 10000000000452L, 10000000000494L, 10000000000499L, 10000000000501L, 10000000000503L, 10000000000504L, 10000000000511L, 10000000000526L, 10000000000529L, 10000000000530L, 10000000000537L, 10000000000541L, 10000000000544L, 10000000000546L, 10000000000560L, 10000000000609L, 10000000000610L, 10000000000611L, 10000000000612L, 10000000000613L, 10000000000614L, 10000000000616L, 10000000000626L, 10000000000645L, 10000000000648L, 10000000000649L, 10000000000651L, 10000000000652L, 10000000000676L, 10000000000678L, 10000000000680L, 10000000000685L, 10000000000686L, 10000000000711L, 10000000000713L, 10000000000714L, 10000000000717L, 10000000000719L, 10000000000721L, 10000000000722L, 10000000000728L, 10000000000729L, 10000000000730L, 10000000000742L, 10000000000772L, 10000000000774L, 10000000000777L, 10000000000778L, 10000000000782L, 10000000000783L, 10000000000784L, 10000000000785L, 10000000000786L, 10000000000789L, 10000000000793L, 10000000000794L, 10000000000799L, 10000000000801L, 10000000000802L, 10000000000809L, 10000000000810L, 10000000000811L, 10000000000814L, 10000000000816L, 10000000000829L, 10000000000830L, 10000000000831L, 10000000000832L, 10000000000833L, 10000000000839L, 10000000000843L, 10000000000848L, 10000000000855L, 10000000000860L, 10000000000861L, 10000000000890L, 10000000000891L, 10000000000895L, 10000000000908L, 10000000000909L, 10000000000919L, 10000000000920L, 10000000000952L, 10000000000980L, 10000000000981L, 10000000001040L, 10000000001041L, 10000000001042L, 10000000001043L, 10000000001056L, 10000000001057L, 10000000001058L, 10000000001059L, 10000000001061L, 10000000001062L, 10000000001063L, 10000000017400L, 10000000017401L, 10000000017404L, 10000000017405L, 10000000017406L, 10000000017407L, 10000000017409L, 10000000017410L, 10000000017411L, 10000000017412L, 10000000017413L, 10000000017414L, 10000000017416L, 10000000017417L, 10000000017419L, 10000000017420L, 10000000018749L, 10000000019092L, 10000000019093L, 10000000019105L, 10000000019108L, 10000000019916L, 10000000019926L, 10000000019939L, 10000000019944L, 10000000019945L, 10000000019956L, 10000000019958L, 10000000019959L, 10000000019964L, 10000000019987L, 10000000019988L, 10000000019991L, 10000000019995L, 10000000020011L, 10000000020012L, 10000000020013L, 10000000020024L, 10000000020025L, 10000000020030L, 10000000020031L, 10000000020033L, 10000000020055L, 10000000020083L, 10000000020111L, 10000000020118L, 10000000020122L, 10000000020123L, 10000000020124L, 10000000020125L, 10000000020137L, 10000000020138L, 10000000020139L, 10000000020173L, 10000000020201L, 10000000020206L, 10000000020234L, 10000000020240L, 10000000020241L, 10000000020246L, 10000000020247L, 10000000020254L, 10000000020259L, 10000000020276L, 10000000020302L, 10000000020306L, 10000000020312L, 10000000020330L, 10000000020333L, 10000000020338L, 10000000020356L, 10000000020477L, 10000000020495L, 10000000020499L, 10000000020538L, 10000000020539L, 10000000020542L, 10000000020550L, 10000000020554L, 10000000020555L, 10000000020556L, 10000000020566L, 10000000020571L, 10000000020583L, 10000000020584L, 10000000020586L, 10000000020588L, 10000000020589L, 10000000020596L, 10000000020626L, 10000000020639L, 10000000020651L, 10000000020671L, 10000000020672L, 10000000020674L, 10000000020675L, 10000000020676L, 10000000020677L, 10000000020685L, 10000000020686L, 10000000020689L, 10000000020690L, 10000000020691L, 10000000020693L, 10000000020694L, 10000000020695L, 10000000020712L, 10000000020713L, 10000000020714L, 10000000020715L, 10000000020716L, 10000000020717L, 10000000020718L, 10000000020719L, 10000000020720L, 10000000020724L, 10000000020727L, 10000000020728L, 10000000020729L, 10000000020731L, 10000000020732L, 10000000020757L, 10000000020763L, 10000000020764L, 10000000020765L, 10000000020767L, 10000000020768L, 10000000020769L, 10000000020770L, 10000000020771L, 10000000020772L, 10000000020773L, 10000000020805L, 10000000020807L, 10000000020850L, 10000000020854L, 10000000021048L, 10000000021049L, 10000000021069L, 10000000021070L, 10000000021072L, 10000000021080L, 10000000021100L, 10000000021105L, 10000000021109L, 10000000021130L, 10000000021134L, 10000000021135L, 10000000021137L, 10000000021139L, 10000000021142L, 10000000021177L, 10000000021178L, 10000000021179L, 10000000021180L, 10000000021182L, 10000000021183L, 10000000021202L, 10000000021203L, 10000000021204L, 10000000021269L, 10000000021270L, 10000000021271L, 10000000021272L, 10000000021277L, 10000000021278L, 10000000021281L, 10000000021282L, 10000000021284L, 10000000021285L, 10000000021287L, 10000000021296L, 10000000021298L, 10000000021304L, 10000000021313L, 10000000021314L, 10000000021316L, 10000000021342L, 10000000021343L, 10000000021346L, 10000000021347L, 10000000021380L, 10000000021382L, 10000000021422L, 10000000021423L, 10000000021424L, 10000000021456L, 10000000021459L, 10000000021464L, 10000000021466L, 10000000021468L, 10000000021469L, 10000000021471L, 10000000021472L, 10000000021483L, 10000000021485L, 10000000021502L, 10000000021503L, 10000000021504L, 10000000021516L, 10000000021520L, 10000000021526L, 10000000021527L, 10000000021528L, 10000000021529L, 10000000021550L, 10000000021565L, 10000000021568L, 10000000021577L, 10000000021601L, 10000000021603L, 10000000021604L, 10000000021609L, 10000000021614L, 10000000021645L, 10000000021651L, 10000000021652L, 10000000021658L, 10000000021676L, 10000000021699L, 10000000021700L, 10000000021721L, 10000000021722L, 10000000021723L, 10000000021725L, 10000000021772L, 10000000021773L, 10000000021781L, 10000000021784L, 10000000021803L, 10000000021804L, 10000000021805L, 10000000021806L, 10000000021807L, 10000000021811L, 10000000021825L, 10000000021826L, 10000000021861L, 10000000021862L, 10000000021868L, 10000000021869L, 10000000021929L, 10000000021950L, 10000000021956L, 10000000022209L, 10000000022213L, 10000000022214L, 10000000022215L, 10000000022221L, 10000000022223L, 10000000022250L, 10000000022251L, 10000000022260L, 10000000022267L, 10000000022309L, 10000000022324L, 10000000022326L, 10000000022462L, 10000000022466L, 10000000022467L, 10000000022468L, 10000000022482L, 10000000022485L, 10000000022505L, 10000000022506L, 10000000022539L, 10000000022540L, 10000000022546L, 10000000022557L, 10000000022561L, 10000000022562L, 10000000022563L, 10000000022596L, 10000000022598L, 10000000022599L, 10000000022654L, 10000000022690L, 10000000022723L, 10000000022726L, 10000000022728L, 10000000022824L, 10000000022952L, 10000000022959L, 10000000022962L, 10000000022964L, 10000000022973L, 10000000023170L, 10000000023175L, 10000000023176L, 10000000023193L, 10000000023252L, 10000000023295L, 10000000023296L, 10000000023411L, 10000000023412L, 10000000023413L, 10000000023414L, 10000000023415L, 10000000023416L, 10000000023460L, 10000000023461L, 10000000023462L, 10000000023463L, 10000000023464L, 10000000023656L, 10000000023657L, 10000000023662L, 10000000023664L, 10000000023667L, 10000000023799L, 10000000023806L, 10000000023807L, 10000000023808L, 10000000023809L, 10000000023810L, 10000000023841L, 10000000023842L, 10000000023843L, 10000000023850L, 10000000023851L, 10000000023852L, 10000000023853L, 10000000023899L, 10000000023900L, 18000000066L, 26000001027L, 26000001056L, 26000001087L, 26000001103L, 26000001953L, 26000004803L, 26000005062L, 26000005078L, 26000005205L, 26000011761L, 26000016574L, 29000001686L, 29000003080L, 37000007704L, 37000008412L, 37000008421L, 37000008798L, 37000009996L, 37000010571L, 37000019264L, 37000019738L, 37000028473L, 37000040101L, 37000045182L, 37000045195L, 40000001772L, 40000001792L, 40000001806L, 40000001822L, 40000001837L, 40000001992L, 40000002114L, 40000002130L, 40000002147L, 40000005654L, 40000006028L, 40000008891L, 40000010126L, 40000015336L, 40000015369L, 40000016589L, 40000017428L, 40000019107L, 40000040189L, 47000001124L, 47000001125L, 47000001127L, 47000001534L, 47000002323L, 47000002397L, 47000002416L, 47000002434L, 47000007767L, 47000007787L, 47000007803L, 47000007818L, 47000007846L, 47000007860L, 47000007883L, 47000007896L, 47000008101L, 47000051354L, 47000051355L, 47000051357L, 47000051358L, 47000052365L, 47000052366L, 47000052367L, 47000056972L, 47000056973L, 47000056974L, 47000056975L, 47000057055L, 47000057070L, 47000057086L, 47000057148L, 47000057164L, 47000057180L, 47000057196L, 47000057211L, 47000057227L, 47000057243L, 52000001484L, 58000001002L, 58000001027L, 58000001038L, 58000001054L, 58000001065L, 58000001498L, 58000001509L, 6000006279L, 6000008488L, 6000008504L, 6000008525L, 6000009648L, 6000009669L, 6000009686L, 6000038914L, 6000038941L, 6000040128L, 7000001190L, 7000001208L, 7000001251L, 7000001267L]
    return group_list

def get_village_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("village/")
#    village_list = []
#    for key in rs:
#        try:
#            village_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        village_list.append(village_id)
    village_list = [10000000000048L, 10000000000052L, 10000000000053L, 10000000000067L, 10000000000074L, 10000000000077L, 10000000000078L, 10000000000092L, 10000000000093L, 10000000000112L, 10000000000217L, 10000000000230L, 10000000000242L, 10000000000251L, 10000000000252L, 10000000000254L, 10000000000255L, 10000000000257L, 10000000000260L, 10000000000261L, 10000000000264L, 10000000000265L, 10000000000270L, 10000000000271L, 10000000000272L, 10000000000274L, 10000000000275L, 10000000000276L, 10000000000277L, 10000000000279L, 10000000000280L, 10000000000281L, 10000000000283L, 10000000000284L, 10000000000285L, 10000000000286L, 10000000000287L, 10000000000299L, 10000000000304L, 10000000000305L, 10000000000306L, 10000000000307L, 10000000000309L, 10000000000313L, 10000000000341L, 10000000000342L, 10000000000389L, 10000000000407L, 10000000000408L, 10000000000410L, 10000000000412L, 10000000000414L, 10000000000425L, 10000000000507L, 10000000000514L, 10000000000532L, 10000000000536L, 10000000000537L, 10000000000538L, 10000000018674L, 10000000018676L, 10000000019834L, 10000000019835L, 10000000019841L, 10000000019842L, 10000000019843L, 10000000019854L, 10000000019860L, 10000000019862L, 10000000019864L, 10000000019865L, 10000000019873L, 10000000019874L, 10000000019880L, 10000000019882L, 10000000019883L, 10000000019889L, 10000000019891L, 10000000019901L, 10000000019902L, 10000000019913L, 10000000019918L, 10000000019922L, 10000000019929L, 10000000019942L, 10000000019945L, 10000000019946L, 10000000019954L, 10000000019967L, 10000000019968L, 10000000019969L, 10000000019975L, 10000000019978L, 10000000019985L, 10000000019988L, 10000000020020L, 10000000020029L, 10000000020036L, 10000000020040L, 10000000020047L, 10000000020078L, 10000000020079L, 10000000020082L, 10000000020084L, 10000000020085L, 10000000020090L, 10000000020092L, 10000000020093L, 10000000020104L, 10000000020105L, 10000000020106L, 10000000020110L, 10000000020119L, 10000000020120L, 10000000020154L, 10000000020156L, 10000000020158L, 10000000020183L, 10000000020184L, 10000000020198L, 10000000020199L, 10000000020222L, 10000000020271L, 10000000020345L, 10000000020353L, 10000000020369L, 10000000020370L, 10000000020381L, 10000000020390L, 10000000020391L, 10000000020394L, 10000000020411L, 10000000020412L, 10000000020439L, 10000000020444L, 10000000020448L, 10000000020490L, 10000000020509L, 10000000020517L, 10000000020519L, 10000000020538L, 10000000020555L, 10000000020556L, 10000000020557L, 10000000020562L, 10000000020563L, 10000000020571L, 10000000020572L, 10000000020594L, 10000000020617L, 10000000020625L, 10000000020647L, 10000000020649L, 26000001003L, 26000001007L, 26000001009L, 26000011729L, 47000001038L, 47000001044L, 47000001122L, 47000051353L, 47000052364L, 47000056970L, 47000062452L, 7000001207L]
    return village_list
